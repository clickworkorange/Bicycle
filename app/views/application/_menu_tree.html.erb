<%= content_tag :li, class: @page.present? && @page.id == page.id ? "current" : nil do %>
  <%= content_tag(:div) do %>
    <% if page.child? %>
      <%= svg_icon(page.id == page.parent.children.last.id ? "last_child" : "child") %>
    <% end %>
    <%= link_to page do %>
      <%= svg_icon(page.template) %>
      <%= page.title %>
      <% # TODO: text-overflow: ellipsis; %>
    <% end %>
  <% end %>
  <% if @page.present? && page.children.live.any? && (@page.id == page.id || @page.is_descendant_of?(page)) %>
    <%= content_tag :ul do %>
      <% page.children.live.each do |child| %>
        <%= render :partial => "menu_tree", :locals => {:page => child }%>
      <% end %>
    <% end %>
  <% end %>
<% end %>