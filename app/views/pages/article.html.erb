<%= render partial: "header", locals: {page: page} %>

<%= content_tag(:p, class: "date") do 
  concat(content_tag(:span, "#{t("created_at")}: #{l(page.created_at, format: :short)}", class: "created_at"))
  if page.updated_at > page.created_at
    concat(content_tag(:span, " #{t("updated_at")}: #{l(page.updated_at, format: :short)}", class: "updated_at"))
  end
end %>

<%= content_tag(:section, sanitize(Kramdown::Document.new(page.abstract).to_html), class: "abstract") if page.abstract.present? %>

<%= sanitize Kramdown::Document.new(inline_images(page), syntax_highlighter: "rouge", syntax_highlighter_opts: {line_numbers: true, theme: "monokai"}).to_html %>

<% page.images.gallery.each do |image| %>
  <%= link_to(image_tag(url_for(image.image_file.variant(resize_to_limit: [100, nil]))), page_image_path(page, image)) %>
<% end %>

<%= render partial: "children", locals: {page: page} %>